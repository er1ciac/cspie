# SM3 长度扩展攻击

本项目实现了对国密 SM3 散列算法的长度扩展攻击，演示了 Merkle-Damgård 结构哈希函数的固有安全漏洞。

## 攻击原理

### Merkle-Damgård 结构的脆弱性

SM3 采用 Merkle-Damgård 构造，这种结构具有以下特点：

1. **迭代压缩**：将消息分成固定长度的块，逐块处理
2. **状态传递**：每块的处理结果作为下一块的初始状态
3. **最终输出**：最后一块的处理结果即为哈希值

综上，Merkle-Damgård结构的哈希函数只依赖于中间状态和新数据块，导致攻击者能够利用已知哈希值和消息长度，伪造带有额外数据的哈希结果，从而实现长度扩展攻击
### 长度扩展攻击机制

#### 攻击条件

攻击者需要知道：
- 原始消息 M 的哈希值 H(M)
- 原始消息 M 的长度 |M|

#### 攻击过程

1. **状态恢复**
   ```
   原始计算：M → Padding → H(M)
   攻击者获得：H(M) 即为最终的内部状态
   ```

2. **消息扩展**
   ```
   构造新消息：M' = M || Padding(M) || Additional_Data
   ```

3. **哈希计算**
   ```
   H(M') = SM3_Continue(H(M), Additional_Data)
   ```

## 使用方法

### 编译

编译c++文件：
```bash
g++ sm3_extend.cpp -o sm3_extend 
```

## 运行结果

发现伪造的和真实的结果一样，证明了SM3算法存在长度扩展攻击的安全漏洞。

![](./4b.png)
